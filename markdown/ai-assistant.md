# AI 維運智能助手
## 故事背景
   - 阿成是 DeepSpace Lab 的資深工程師，負責 AI 平台「星探」的開發與維運，支援上百台客製化機器人。然而，隨著部署規模擴大，他也面臨監控與運維的痛點。例如某次 EC2 主機 CPU 飆高導致回應遲緩，用戶先發現問題，才緊急排查，效率低下。AWS 成本管理也讓團隊頭痛，帳單常像驚喜包，異常費用總是事後才發現。此外，App Runner API 錯誤時無警示、Guardrail 的觸發紀錄需人工審查，都讓問題不易即時掌握。為此，阿成著手導入智能監控與預警機制，讓「星探」具備自我診斷與調整能力，確保平台在穩定運作的同時，守住 DeepSpace Lab 與客戶之間的信任。
	- 我們為「星探」配備了一位最了解它的「智能總管」**——正是另一位，更深層次的**「星探」！
	- 這位「智能總管星探」擁有超越人類的速度和精度，它不再是等到「星探」的服務出現明顯故障才去搶救，而是在「星探」還充滿活力的日常中，就默默地、無時無刻地監測著她體內每一個「運作脈動」。
- ## 使用情境
	- ### 一鍵查詢主機使用率，預防潛在風險
		- 當我們模擬讓「星探」所在的 **Dify EC2 實例**的 CPU 利用率飆升時，傳統上，這會是工程師惡夢的開始。但現在透過它會串接後端監控 API，能從 **CloudWatch** 精準地捕獲到 **CPUUtilization** 指標。
	- ### 雲端帳單透明化，從「事後知道」到「事前預警」
		- 我們可以利用「星探」透過API查詢的方式向AWS Billing取得過去的成本，甚至能幫我們評估未來幾天的AWS服務花費。
	- ### 監控自己的監控：App Runner 錯誤偵測實務
		- **服務自己也會監控自己？星探做到了**
		- 當我們刻意在API程式碼中引入會造成 **格式錯誤（Malformed Response）** 的程式碼，導致返回資料格式不符合預期，或是遇到 **連線失敗（Connection Refused/Reset）**，API 嘗試連線時被拒絕或中斷，甚至發生 **資源不足（Resource Exhausted）**，像是記憶體耗盡、配額用盡等狀況，App Runner 的日誌會顯示大量相關錯誤訊息，對應的錯誤指標也會在 CloudWatch 中迅速上升。
	- ## 敏感訊息即刻攔截，電商客服更安心
		- 當用戶輸入如「查詢他人訂單資訊」等違規請求時，「星探」透過內建**提示詞限制（Prompt-based Guardrails）**立即偵測敏感內容，並回覆預設安全訊息：
		- 根據平台安全政策，此內容無法處理。
		- 無需依賴模型內建防護，而是由開發者自定義提示詞實現高彈性控管，讓 AI 客服即時反應、守護資訊安全，全面提升電商客服的安心與信賴感。
- ## 技術架構
    - ![技術架構圖](./img/AWS_AI_Drawio.png)

		### 架構組件與說明

		#### 1. 使用者端（User Interface）

		- 使用者以自然語言發出查詢指令，例如：「目前 EC2 主機 CPU 使用率為何？」「有推薦的拖鞋產品嗎？」此設計提升操作直覺性與便捷性，降低技術門檻。

		#### 2. AI 中樞模組：Dify 平台與 Dify Agent

		- 部署於 AWS EC2 的 Dify 平台負責接收並處理查詢。
		- 核心組件 Dify Agent 具備語意解析能力，能自動選擇最適合的 API 工具，提升查詢效率與準確度。

		#### 3. API 工具服務（AWS App Runner）
        
		- 使用 Python FastAPI 框架開發，Docker 容器化並部署於 App Runner，高可用、低延遲、可自動擴展。

		- **主要功能：**
    		- 擷取 EC2 指標
    		- 查詢 AWS Billing 資訊
    		- 查詢 AWS CloudWatch Logs

		#### 4. 資料來源與整合層

		- **AWS CloudWatch**：監控 EC2 與 App Runner 的指標與日誌。
		- **AWS Billing API**：提供實時的成本報表。
		- **RDS + 向量化知識庫（RAG）**：電商商品資料經過向量化後匯入知識庫，提升語義檢索效率。

		#### 5. AI 模型整合（AWS Bedrock）

		- 查詢結果送交 Claude 模型進行語意分析與回答生成。
		- 回應格式固定，條列清楚，提升可讀性與安全性。

		#### 6. 權限控管與身份管理

		- **AWS IAM Identity Center**：集中帳號與授權管理。
		- **IAM 角色與權限策略**：最小權限原則控管 API 存取 CloudWatch、RDS、Billing 等服務。

## 技術成果
  - ![image1](./img/AI_1.png)
  - ![image1](./img/AI_2.png)
  - ![image1](./img/AI_3.png)
  - ![image1](./img/AI_4.png)
  - ![image1](./img/AI_5.png)
  - ![image1](./img/AI_6.png)
  - ![image1](./img/AI_7.png)